# ZeroClaw — Mattermost Hub Configuration Template (single-process, 6 bots)
#
# All 6 ATLA bots run in a single ZeroClaw process.
# Each [[channels_config.mattermost_bots]] entry spawns one MattermostChannel
# instance with its own bot token. They share the Ollama provider and SQLite memory.
#
# Usage:
#   cp config/config.mattermost.example.toml config/config.mattermost.toml
#   # fill in bot tokens from .envrc.mattermost
#   source .envrc.mattermost
#   zeroclaw start --config config/config.mattermost.toml
#
# Bot tokens are in .envrc.mattermost (gitignored). Load with:
#   source .envrc.mattermost
#
# Architecture:
#   One ZeroClaw process — six MattermostChannel instances (one per bot token).
#   Each bot entry has `mode = "<name>"` linking it to a [modes.<name>] section.
#   The channel IS the mode: Mattermost routes @mentions to the right bot account,
#   so each bot gets its own ChannelRuntimeContext with distinct system prompt,
#   tool allowlist, and temperature. Provider and Memory are shared across all bots.
#   See docs/planning/spike-mattermost-hub.md for full design.
# ─────────────────────────────────────────────────────────────────

# ── Shared Provider (Ollama) ──────────────────────────────────────
default_provider = "ollama"
default_model = "qwen3:14b"
api_key = "http://localhost:11434"
default_temperature = 0.5

# ── Shared Memory ─────────────────────────────────────────────────
[memory]
backend = "sqlite"
# All bots share one SQLite file for cross-bot context
sqlite_path = "~/.zeroclaw/mattermost-hub.db"

# ── Disable CLI (headless multi-bot mode) ─────────────────────────
[channels_config]
cli = false

# ═══════════════════════════════════════════════════════════════════
# BOT: @sokka — PM (Linear, standups, backlog)
# Temperature: 0.1  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_SOKKA
bot_token = "REPLACE_WITH_MM_TOKEN_SOKKA"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "sokka"

# ═══════════════════════════════════════════════════════════════════
# BOT: @toph — DevOps (shell, deployments, infra)
# Temperature: 0.3  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_TOPH
bot_token = "REPLACE_WITH_MM_TOKEN_TOPH"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "toph"

# ═══════════════════════════════════════════════════════════════════
# BOT: @azula — Security (code review, scanning, audit)
# Temperature: 0.1  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_AZULA
bot_token = "REPLACE_WITH_MM_TOKEN_AZULA"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "azula"

# ═══════════════════════════════════════════════════════════════════
# BOT: @iroh — Creative (ideation, architecture)
# Temperature: 0.8  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_IROH
bot_token = "REPLACE_WITH_MM_TOKEN_IROH"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "iroh"

# ═══════════════════════════════════════════════════════════════════
# BOT: @katara — Dev (code, debugging, PR review)
# Temperature: 0.3  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_KATARA
bot_token = "REPLACE_WITH_MM_TOKEN_KATARA"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "katara"

# ═══════════════════════════════════════════════════════════════════
# BOT: @aang — Coordinator (delegate, big picture)
# Temperature: 0.5  |  mention_only: true
# ═══════════════════════════════════════════════════════════════════
[[channels_config.mattermost_bots]]
url = "http://localhost:8065"
# Token from: echo $MM_TOKEN_AANG
bot_token = "REPLACE_WITH_MM_TOKEN_AANG"
allowed_users = ["*"]
thread_replies = true
mention_only = true
mode = "aang"

# ═══════════════════════════════════════════════════════════════════
# Per-mode brain definitions
#
# Each [modes.<name>] entry is linked to the bot above via `mode = "<name>"`.
# The bot gets its own ChannelRuntimeContext using:
#   - system_prompt: built from aieos_path identity file (optional)
#   - tool_allowlist: only these tools are offered to the model
#   - temperature: overrides default_temperature for this bot
#
# Identity files live in modes/<name>/identity.json (AIEOS format).
# See docs/planning/spike-mattermost-hub.md for the AIEOS schema.
# ═══════════════════════════════════════════════════════════════════

[modes.sokka]
# Sokka: PM bot — Linear project management, standups, backlog grooming
identity_format = "aieos"
aieos_path = "modes/sokka/identity.json"
tool_allowlist = ["linear", "memory_store", "memory_recall", "memory_forget", "ask_user"]
temperature = 0.1

[modes.toph]
# Toph: DevOps bot — shell execution, file ops, HTTP requests, infra
identity_format = "aieos"
aieos_path = "modes/toph/identity.json"
tool_allowlist = ["shell", "file_read", "file_write", "file_edit", "glob", "http_request", "ask_user"]
temperature = 0.3

[modes.azula]
# Azula: Security bot — code review, vulnerability scanning, audit
identity_format = "aieos"
aieos_path = "modes/azula/identity.json"
tool_allowlist = ["content_search", "file_read", "glob", "ask_user"]
temperature = 0.1

[modes.iroh]
# Iroh: Creative bot — ideation, architecture, mentorship
identity_format = "aieos"
aieos_path = "modes/iroh/identity.json"
tool_allowlist = ["memory_store", "memory_recall", "ask_user"]
temperature = 0.8

[modes.katara]
# Katara: Dev bot — coding, debugging, PR review
identity_format = "aieos"
aieos_path = "modes/katara/identity.json"
tool_allowlist = ["shell", "file_read", "file_write", "file_edit", "glob", "content_search", "ask_user"]
temperature = 0.3

[modes.aang]
# Aang: Coordinator bot — delegation, big picture, cross-bot orchestration
identity_format = "aieos"
aieos_path = "modes/aang/identity.json"
tool_allowlist = ["delegate", "memory_store", "memory_recall", "ask_user"]
temperature = 0.5
